<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="//cdn.staticfile.net/Primer/21.0.7/primer.css" rel="stylesheet" />
    <link rel="icon" href="https://img.witter.top/file/b037878209903b7d5bb17.jpg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="logrotate æ˜¯ä¸€ä¸ª linux ç³»ç»Ÿæ—¥å¿—çš„ç®¡ç†å·¥å…·ã€‚">
<meta property="og:title" content="Logrotate">
<meta property="og:description" content="logrotate æ˜¯ä¸€ä¸ª linux ç³»ç»Ÿæ—¥å¿—çš„ç®¡ç†å·¥å…·ã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.witter.top/post/Logrotate.html">
<meta property="og:image" content="https://img.witter.top/file/b037878209903b7d5bb17.jpg">
<title>Logrotate</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />

</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Logrotate</h1>
<div class="title-right">
    <a href="https://blog.witter.top" id="buttonHome" class="btn btn-invisible circle" title="é¦–é¡µ">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/ljwtorch/ljwtorch.github.io/issues/10" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="åˆ‡æ¢ä¸»é¢˜">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p>logrotate æ˜¯ä¸€ä¸ª linux ç³»ç»Ÿæ—¥å¿—çš„ç®¡ç†å·¥å…·ã€‚å¯ä»¥å¯¹å•ä¸ªæ—¥å¿—æ–‡ä»¶æˆ–è€…æŸä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶æŒ‰æ—¶é—´ / å¤§å°è¿›è¡Œåˆ‡å‰²ï¼Œå‹ç¼©æ“ä½œï¼›æŒ‡å®šæ—¥å¿—ä¿å­˜æ•°é‡ï¼›è¿˜å¯ä»¥åœ¨åˆ‡å‰²ä¹‹åè¿è¡Œè‡ªå®šä¹‰å‘½ä»¤ã€‚</p>
<p>logrotate æ˜¯åŸºäº crontab è¿è¡Œçš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶é—´ç‚¹æ˜¯ç”± crontab æ§åˆ¶çš„ï¼Œå…·ä½“å¯ä»¥æŸ¥è¯¢ crontab çš„é…ç½®æ–‡ä»¶ /etc/anacrontabã€‚ ç³»ç»Ÿä¼šæŒ‰ç…§è®¡åˆ’çš„é¢‘ç‡è¿è¡Œ logrotateï¼Œé€šå¸¸æ˜¯æ¯å¤©ã€‚åœ¨å¤§å¤šæ•°çš„ Linux å‘è¡Œç‰ˆæœ¬ä¸Šï¼Œè®¡åˆ’æ¯å¤©è¿è¡Œçš„è„šæœ¬ä½äº /etc/cron.daily/logrotateã€‚</p>
<blockquote>
<p>/etc/cron.daily</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#!</span>/bin/sh</span>

<span class="pl-c"><span class="pl-c">#</span> skip in favour of systemd timer</span>
<span class="pl-k">if</span> [ <span class="pl-k">-d</span> /run/systemd/system ]<span class="pl-k">;</span> <span class="pl-k">then</span>
 <span class="pl-c1">exit</span> 0
<span class="pl-k">fi</span>

<span class="pl-c"><span class="pl-c">#</span> this cronjob persists removals (but not purges)</span>
<span class="pl-k">if</span> [ <span class="pl-k">!</span> <span class="pl-k">-x</span> /usr/sbin/logrotate ]<span class="pl-k">;</span> <span class="pl-k">then</span>
 <span class="pl-c1">exit</span> 0
<span class="pl-k">fi</span>

/usr/sbin/logrotate /etc/logrotate.conf
EXITVALUE=<span class="pl-smi">$?</span>
<span class="pl-k">if</span> [ <span class="pl-smi">$EXITVALUE</span> <span class="pl-k">!=</span> 0 ]<span class="pl-k">;</span> <span class="pl-k">then</span>
 /usr/bin/logger -t logrotate <span class="pl-s"><span class="pl-pds">"</span>ALERT exited abnormally with [<span class="pl-smi">$EXITVALUE</span>]<span class="pl-pds">"</span></span>
<span class="pl-k">fi</span>
<span class="pl-c1">exit</span> <span class="pl-smi">$EXITVALUE</span></pre></div>
</blockquote>
<h2>åŸç†</h2>
<p>logrotate æ˜¯æ€ä¹ˆåšåˆ°æ»šåŠ¨æ—¥å¿—æ—¶ä¸å½±å“ç¨‹åºæ­£å¸¸çš„æ—¥å¿—è¾“å‡ºå‘¢ï¼Ÿ</p>
<ol>
<li><strong>create</strong>ï¼šmv+create æ‰§è¡Œå®Œä¹‹åï¼Œé€šçŸ¥åº”ç”¨é‡æ–°åœ¨æ–°æ–‡ä»¶å†™å…¥
<ul>
<li>é‡å‘½åæ­£åœ¨è¾“å‡ºæ—¥å¿—æ–‡ä»¶ï¼Œå› ä¸ºé‡å‘½ååªä¿®æ”¹ç›®å½•ä»¥åŠæ–‡ä»¶çš„åç§°ï¼Œè€Œè¿›ç¨‹æ“ä½œæ–‡ä»¶ä½¿ç”¨çš„æ˜¯ inodeï¼Œæ‰€ä»¥å¹¶ä¸å½±å“åŸç¨‹åºç»§ç»­è¾“å‡ºæ—¥å¿—ï¼›</li>
<li>åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ–‡ä»¶åå’ŒåŸæ—¥å¿—æ–‡ä»¶ä¸€æ ·ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶åªæ˜¯æ–‡ä»¶åç§°ä¸€æ ·ï¼Œè€Œ inode ç¼–å·ä¸åŒï¼ŒåŸç¨‹åºè¾“å‡ºçš„æ—¥å¿—è¿˜æ˜¯å¾€åŸæ—¥å¿—æ–‡ä»¶è¾“å‡ºï¼›</li>
<li>æœ€åé€šè¿‡æŸäº›æ–¹å¼é€šçŸ¥ç¨‹åºï¼Œé‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼›ç”±äºé‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ä¼šç”¨åˆ°æ–‡ä»¶è·¯å¾„è€Œé inode ç¼–å·ï¼Œæ‰€ä»¥æ‰“å¼€çš„æ˜¯æ–°çš„æ—¥å¿—æ–‡ä»¶ï¼›</li>
</ul>
</li>
<li><strong>copytruncate</strong>ï¼šæŠŠæ­£åœ¨è¾“å‡ºçš„æ—¥å¿—æ‹· (copy) ä¸€ä»½å‡ºæ¥ï¼Œå†æ¸…ç©º (trucate) åŸæ¥çš„æ—¥å¿—ï¼›æ¸…ç©ºæ“ä½œæ¯”è¾ƒå¿«ï¼Œä½†å¦‚æœæ—¥å¿—æ–‡ä»¶å¤ªå¤§ï¼Œé‚£ä¹ˆå¤åˆ¶å°±ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œä»è€Œå¯èƒ½å¯¼è‡´éƒ¨åˆ†æ—¥å¿—ä¸¢å¤±ï¼Œä¸è¿‡è¿™ç§æ–¹å¼ä¸éœ€è¦åº”ç”¨ç¨‹åºçš„æ”¯æŒ
<ul>
<li>å°†å½“å‰æ­£åœ¨è¾“å‡ºçš„æ—¥å¿—æ–‡ä»¶å¤åˆ¶ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œæ­¤æ—¶ç¨‹åºä»ç„¶å°†æ—¥å¿—è¾“å‡ºåˆ°åŸæ¥æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶ï¼ŒåŸæ–‡ä»¶åä¹Ÿæ²¡æœ‰å˜ã€‚</li>
<li>æ¸…ç©ºæ—¥å¿—æ–‡ä»¶ï¼ŒåŸç¨‹åºä»ç„¶è¿˜æ˜¯è¾“å‡ºåˆ°é¢„æ¡ˆæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå› ä¸ºæ¸…ç©ºæ–‡ä»¶åªæŠŠæ–‡ä»¶çš„å†…å®¹åˆ é™¤äº†ï¼Œè€Œ inode å¹¶æ²¡æ”¹å˜ï¼Œåç»­æ—¥å¿—çš„è¾“å‡ºä»ç„¶å†™å…¥è¯¥æ–‡ä»¶ä¸­ã€‚</li>
</ul>
</li>
</ol>
<h2>Linuxæ–‡ä»¶æ“ä½œæœºåˆ¶</h2>
<p>Linux æ–‡ä»¶ç³»ç»Ÿé‡Œæ–‡ä»¶å’Œæ–‡ä»¶åçš„å…³ç³»å¦‚ä¸‹å›¾ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/c87db08d5377b4bea0c4bdd7f9ff595165bd3e76ab9dd17e917f7b5d9230d299/68747470733a2f2f696d672e7769747465722e746f702f66696c652f6565326630393939356538343738363866313237612e706e67"><img src="https://camo.githubusercontent.com/c87db08d5377b4bea0c4bdd7f9ff595165bd3e76ab9dd17e917f7b5d9230d299/68747470733a2f2f696d672e7769747465722e746f702f66696c652f6565326630393939356538343738363866313237612e706e67" alt="image-20230131094227080" data-canonical-src="https://img.witter.top/file/ee2f09995e847868f127a.png" style="max-width: 100%;"></a></p>
<p>ç›®å½•ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œå­˜ç€æ–‡ä»¶åå’Œå¯¹åº”çš„ inode ç¼–å·ã€‚é€šè¿‡è¿™ä¸ª inode ç¼–å·å¯ä»¥æŸ¥åˆ°æ–‡ä»¶çš„å…ƒæ•°æ®å’Œæ–‡ä»¶å†…å®¹ã€‚æ–‡ä»¶çš„å…ƒæ•°æ®æœ‰å¼•ç”¨è®¡æ•°ã€æ“ä½œæƒé™ã€æ‹¥æœ‰è€… IDã€åˆ›å»ºæ—¶é—´ã€æœ€åä¿®æ”¹æ—¶é—´ç­‰ç­‰ã€‚æ–‡ä»¶ä»¶åå¹¶ä¸åœ¨å…ƒæ•°æ®é‡Œè€Œæ˜¯åœ¨ç›®å½•æ–‡ä»¶ä¸­ã€‚å› æ­¤æ–‡ä»¶æ”¹åã€ç§»åŠ¨ï¼Œéƒ½ä¸ä¼šä¿®æ”¹æ–‡ä»¶ï¼Œè€Œæ˜¯ä¿®æ”¹ç›®å½•æ–‡ä»¶ã€‚</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2cbf940679c1e3b736615fc1756c711e407139eff9dfdf3bfc14e2b3be0da578/68747470733a2f2f696d672e7769747465722e746f702f66696c652f6664383032383665383539393131396462353735372e706e67"><img src="https://camo.githubusercontent.com/2cbf940679c1e3b736615fc1756c711e407139eff9dfdf3bfc14e2b3be0da578/68747470733a2f2f696d672e7769747465722e746f702f66696c652f6664383032383665383539393131396462353735372e706e67" alt="image-20230131094747354" data-canonical-src="https://img.witter.top/file/fd80286e8599119db5757.png" style="max-width: 100%;"></a></p>
<p>è¿›ç¨‹æ¯æ–°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ç»™è¿™ä¸ªæ–‡ä»¶ã€‚æ–‡ä»¶æè¿°ç¬¦å¯¹åº”ç€ä¸€ä¸ªæ–‡ä»¶è¡¨ã€‚è¡¨é‡Œé¢å­˜ç€æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼ˆ<code class="notranslate">O_APPEND</code>/<code class="notranslate">O_CREAT</code>/<code class="notranslate">O_DIRECT</code>...ï¼‰ã€å½“å‰æ–‡ä»¶ä½ç½®å’Œæ–‡ä»¶çš„ inode ä¿¡æ¯ã€‚ç³»ç»Ÿä¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºç‹¬ç«‹çš„æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶è¡¨ï¼Œä¸åŒè¿›ç¨‹æ˜¯ä¸ä¼šå…±ç”¨åŒä¸€ä¸ªæ–‡ä»¶è¡¨ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŒæ—¶ç”¨ä¸åŒçš„çŠ¶æ€æ“ä½œåŒä¸€ä¸ªæ–‡ä»¶çš„ä¸åŒä½ç½®ã€‚æ–‡ä»¶è¡¨ä¸­å­˜çš„æ˜¯ inode ä¿¡æ¯è€Œä¸æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œæ‰€ä»¥æ–‡ä»¶è·¯å¾„å‘ç”Ÿæ”¹å˜ä¸ä¼šå½±å“æ–‡ä»¶æ“ä½œã€‚</p>
<h2>Logrotateé…ç½®</h2>
<p>æ‰§è¡Œæ–‡ä»¶ï¼š <code class="notranslate">/usr/sbin/logrotate</code></p>
<p>ä¸»é…ç½®æ–‡ä»¶: <code class="notranslate">/etc/logrotate.conf</code></p>
<p>è‡ªå®šä¹‰é…ç½®æ–‡ä»¶: <code class="notranslate">/etc/logrotate.d/*.conf</code></p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡ï¼Œæœ¬è´¨ä¸Šlogrotateæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸æ˜¯ä»¥deamonè¿è¡Œ</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> see "man logrotate" for details</span>
<span class="pl-c"><span class="pl-c">#</span> rotate log files weekly</span>
<span class="pl-c"><span class="pl-c">#</span> æ¯å‘¨è½®æ¢æ—¥å¿—æ–‡ä»¶</span>
weekly

<span class="pl-c"><span class="pl-c">#</span> use the adm group by default, since this is the owning group of /var/log/syslog.</span>
<span class="pl-c"><span class="pl-c">#</span> é»˜è®¤ä½¿ç”¨ adm ç»„ï¼Œå› ä¸ºè¿™æ˜¯ /var/log/syslog çš„æ‹¥æœ‰ç»„ã€‚</span>
su root adm

<span class="pl-c"><span class="pl-c">#</span> keep 4 weeks worth of backlogs</span>
<span class="pl-c"><span class="pl-c">#</span> ä¿æŒ4å‘¨çš„ç§¯å‹é‡</span>
rotate 4

<span class="pl-c"><span class="pl-c">#</span> create new (empty) log files after rotating old ones</span>
<span class="pl-c"><span class="pl-c">#</span> åœ¨è½®æ¢æ—§çš„æ—¥å¿—æ–‡ä»¶ååˆ›å»ºæ–°çš„ï¼ˆç©ºçš„ï¼‰æ—¥å¿—æ–‡ä»¶</span>
create

<span class="pl-c"><span class="pl-c">#</span> use date as a suffix of the rotated file</span>
<span class="pl-c"><span class="pl-c">#</span> ä½¿ç”¨æ—¥æœŸä½œä¸ºæ—‹è½¬åçš„æ–‡ä»¶çš„åç¼€</span>
<span class="pl-c"><span class="pl-c">#</span>dateext</span>

<span class="pl-c"><span class="pl-c">#</span> uncomment this if you want your log files compressed</span>
<span class="pl-c"><span class="pl-c">#</span> å¦‚æœä½ æƒ³è®©ä½ çš„æ—¥å¿—æ–‡ä»¶è¢«å‹ç¼©ï¼Œè¯·å–æ¶ˆè¿™ä¸ªæ³¨é‡Š</span>
<span class="pl-c"><span class="pl-c">#</span>compress</span>

<span class="pl-c"><span class="pl-c">#</span> packages drop log rotation information into this directory</span>
<span class="pl-c"><span class="pl-c">#</span> è½¯ä»¶åŒ…å°†æ—¥å¿—è½®æ¢ä¿¡æ¯æ”¾å…¥æ­¤ç›®å½•</span>
include /etc/logrotate.d

<span class="pl-c"><span class="pl-c">#</span> system-specific logs may be also be configured here.</span>
<span class="pl-c"><span class="pl-c">#</span> ç³»ç»Ÿç‰¹å®šçš„æ—¥å¿—ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œé…ç½®ã€‚</span></pre></div>
<p><strong>/etc/anacrontab</strong></p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> /etc/anacrontab: configuration file for anacron</span>

<span class="pl-c"><span class="pl-c">#</span> See anacron(8) and anacrontab(5) for details.</span>

SHELL=/bin/sh
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
<span class="pl-c"><span class="pl-c">#</span> the maximal random delay added to the base delay of the jobs</span>
RANDOM_DELAY=45
<span class="pl-c"><span class="pl-c">#</span> the jobs will be started during the following hours only</span>
START_HOURS_RANGE=3-22

<span class="pl-c"><span class="pl-c">#</span>period in days   delay in minutes   job-identifier   command</span>
1       5       cron.daily              nice run-parts /etc/cron.daily
7       25      cron.weekly             nice run-parts /etc/cron.weekly
@monthly 45     cron.monthly            nice run-parts /etc/cron.monthly</pre></div>
<p>å¦‚æœæœºå™¨æ²¡æœ‰å…³æœºï¼Œé»˜è®¤çš„logrotateï¼ˆé…ç½®æ–‡ä»¶é‡Œè®¾ç½®çš„æ˜¯cron.dailyï¼‰ä¸€èˆ¬ä¼šåœ¨æ¯å¤©çš„3ç‚¹05åˆ†åˆ°3ç‚¹50åˆ†ä¹‹é—´æ‰§è¡Œï¼›</p>
<p>çœŸå®çš„å»¶è¿Ÿæ—¶é—´æ˜¯ RANDOM_DELAY + delay in minutesï¼›</p>
<p>å¦‚æœåœ¨3-22è¿™ä¸ªæ—¶é—´æ®µå†…æœåŠ¡å™¨å¤„äºå…³æœºçŠ¶æ€,åˆ™logrotateä¼šåœ¨æœºå™¨å¼€æœº5åˆ†é’Ÿåæ‰§è¡Œåˆ†å‰²æ—¥å¿—çš„æ“ä½œï¼›</p>
<h2>Logrotateè¿è¡Œ</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">ç”¨æ³•: logrotate [OPTION...] <span class="pl-k">&lt;</span>configfile<span class="pl-k">&gt;</span>
  -d, --debug               <span class="pl-c"><span class="pl-c">#</span>Don't do anything, just test and print debug messages</span>
  							<span class="pl-c"><span class="pl-c">#</span>ä¸åšä»»ä½•äº‹æƒ…ï¼Œåªæ˜¯æµ‹è¯•å’Œæ‰“å°è°ƒè¯•ä¿¡æ¯</span>
  -f, --force               <span class="pl-c"><span class="pl-c">#</span>Force file rotation</span>
  							<span class="pl-c"><span class="pl-c">#</span>å¼ºåˆ¶æ—‹è½¬æ–‡ä»¶</span>
  -m, --mail=command        <span class="pl-c"><span class="pl-c">#</span>Command to send mail (instead of `/usr/bin/mail')</span>
  							<span class="pl-c"><span class="pl-c">#</span>å‘é€é‚®ä»¶çš„å‘½ä»¤ï¼ˆè€Œä¸æ˜¯`/usr/bin/mail'ï¼‰</span>
  -s, --state=statefile     <span class="pl-c"><span class="pl-c">#</span>Path of state file</span>
  							<span class="pl-c"><span class="pl-c">#</span>çŠ¶æ€æ–‡ä»¶çš„è·¯å¾„</span>
  -v, --verbose             <span class="pl-c"><span class="pl-c">#</span>Display messages during rotation</span>
  							<span class="pl-c"><span class="pl-c">#</span>æ˜¾ç¤ºæ—‹è½¬è¿‡ç¨‹ä¸­çš„ä¿¡æ¯</span>
  -l, --log=logfile         <span class="pl-c"><span class="pl-c">#</span>Log file or 'syslog' to log to syslog</span>
  							<span class="pl-c"><span class="pl-c">#</span>æ—¥å¿—æ–‡ä»¶æˆ– "syslog "æ¥è®°å½•åˆ°syslogã€‚</span>
      --version             Display version information</pre></div>
<p>debug æ¨¡å¼ï¼šæŒ‡å®š <code class="notranslate">[-d|--debug]</code></p>
<pre lang="text" class="notranslate"><code class="notranslate">logrotate -d &lt;configfile&gt;
</code></pre>
<p>å¹¶ä¸ä¼šçœŸæ­£è¿›è¡Œ rotate æˆ–è€… compress æ“ä½œï¼Œä½†æ˜¯ä¼šæ‰“å°å‡ºæ•´ä¸ªæ‰§è¡Œçš„æµç¨‹ï¼Œå’Œè°ƒç”¨çš„è„šæœ¬ç­‰è¯¦ç»†ä¿¡æ¯ã€‚</p>
<p>verbose æ¨¡å¼ï¼š æŒ‡å®š <code class="notranslate">[-v|--verbose]</code></p>
<pre lang="text" class="notranslate"><code class="notranslate">logrotate -v &lt;configfile&gt;
</code></pre>
<p>ä¼šçœŸæ­£æ‰§è¡Œæ“ä½œï¼Œæ‰“å°å‡ºè¯¦ç»†ä¿¡æ¯ï¼ˆdebug æ¨¡å¼ï¼Œé»˜è®¤æ˜¯å¼€å¯ verboseï¼‰</p>
<p>stateï¼šæŒ‡å®šä¸€ä¸ªçŠ¶æ€æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶è®°å½•logrotateä¸Šæ¬¡è¿è¡Œæ—¶æ‰€çœ‹åˆ°å’Œæ‰§è¡Œçš„æ“ä½œï¼Œä»¥ä¾¿æŒ‡å¯¼ä»–ä¸‹æ¬¡è¿è¡Œæ—¶è¦æ‰§è¡Œçš„æ“ä½œ</p>
<h2>Logrotateå‚æ•°</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">/var/log/log_file {
    monthly
    rotate 5
    compress
    delaycompress
    missingok
    notifempty
    create 644 root root
    postrotate
        /usr/bin/killall -HUP rsyslogd
    endscript
}</pre></div>
<ul>
<li>monthly: æ—¥å¿—æ–‡ä»¶å°†æŒ‰æœˆè½®å¾ªã€‚å…¶å®ƒå¯ç”¨å€¼ä¸º<code class="notranslate">daily</code>ï¼Œ<code class="notranslate">weekly</code>æˆ–è€…<code class="notranslate">yearly</code>ã€‚</li>
<li>rotate 5: ä¸€æ¬¡å°†å­˜å‚¨ 5 ä¸ªå½’æ¡£æ—¥å¿—ã€‚å¯¹äºç¬¬å…­ä¸ªå½’æ¡£ï¼Œæ—¶é—´æœ€ä¹…çš„å½’æ¡£å°†è¢«åˆ é™¤ã€‚</li>
<li>compress: åœ¨è½®å¾ªä»»åŠ¡å®Œæˆåï¼Œå·²è½®å¾ªçš„å½’æ¡£å°†ä½¿ç”¨ gzip è¿›è¡Œå‹ç¼©ã€‚</li>
<li>delaycompress: æ€»æ˜¯ä¸ compress é€‰é¡¹ä¸€èµ·ç”¨ï¼Œdelaycompress é€‰é¡¹æŒ‡ç¤º logrotate ä¸è¦å°†æœ€è¿‘çš„å½’æ¡£å‹ç¼©ï¼Œå‹ç¼© å°†åœ¨ä¸‹ä¸€æ¬¡è½®å¾ªå‘¨æœŸè¿›è¡Œã€‚è¿™åœ¨ä½ æˆ–ä»»ä½•è½¯ä»¶ä»ç„¶éœ€è¦è¯»å–æœ€æ–°å½’æ¡£æ—¶å¾ˆæœ‰ç”¨ã€‚</li>
<li>missingok: åœ¨æ—¥å¿—è½®å¾ªæœŸé—´ï¼Œä»»ä½•é”™è¯¯å°†è¢«å¿½ç•¥ï¼Œä¾‹å¦‚ â€œæ–‡ä»¶æ— æ³•æ‰¾åˆ°â€ ä¹‹ç±»çš„é”™è¯¯ã€‚</li>
<li>notifempty: å¦‚æœæ—¥å¿—æ–‡ä»¶ä¸ºç©ºï¼Œè½®å¾ªä¸ä¼šè¿›è¡Œã€‚</li>
<li>create 644 root root: ä»¥æŒ‡å®šçš„æƒé™åˆ›å»ºå…¨æ–°çš„æ—¥å¿—æ–‡ä»¶ï¼ŒåŒæ—¶ logrotate ä¹Ÿä¼šé‡å‘½ååŸå§‹æ—¥å¿—æ–‡ä»¶ã€‚</li>
<li>postrotate/endscript: åœ¨æ‰€æœ‰å…¶å®ƒæŒ‡ä»¤å®Œæˆåï¼Œpostrotate å’Œ endscript é‡Œé¢æŒ‡å®šçš„å‘½ä»¤å°†è¢«æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œrsyslogd è¿›ç¨‹å°†ç«‹å³å†æ¬¡è¯»å–å…¶é…ç½®å¹¶ç»§ç»­è¿è¡Œã€‚</li>
</ul>
<blockquote>
<p>å¸¸è§é…ç½®å‚æ•°</p>
</blockquote>
<ol>
<li>daily ï¼šæŒ‡å®šè½¬å‚¨å‘¨æœŸä¸ºæ¯å¤©</li>
<li>weekly ï¼šæŒ‡å®šè½¬å‚¨å‘¨æœŸä¸ºæ¯å‘¨</li>
<li>monthly ï¼šæŒ‡å®šè½¬å‚¨å‘¨æœŸä¸ºæ¯æœˆ</li>
<li>dateextï¼šå½’æ¡£æ—§ç‰ˆæœ¬çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªæ¯æ—¥æ‰©å±•åï¼Œå¦‚YYYMMDDï¼Œè€Œä¸æ˜¯ç®€å•åœ°æ·»åŠ ä¸€ä¸ªæ•°å­—ã€‚æ‰©å±•åå¯ä»¥ä½¿ç”¨dateformaté€‰é¡¹è¿›è¡Œé…ç½®</li>
<li>dateformatï¼šåªå…è®¸ä½¿ç”¨%Y %m %då’Œ%sæŒ‡å®šå™¨ã€‚é»˜è®¤å€¼æ˜¯-%Y%m%dï¼Œç”±è¿™ç§æ ¼å¼äº§ç”Ÿçš„æ—¥æœŸæˆ³å¿…é¡»æ˜¯è¯æ³•å¯æ’åºçš„ï¼ˆå³å…ˆæ˜¯å¹´ï¼Œç„¶åæ˜¯æœˆï¼Œç„¶åæ˜¯æ—¥ã€‚ä¾‹å¦‚ï¼Œ2001/12/01</li>
<li>rotate count ï¼šæŒ‡å®šæ—¥å¿—æ–‡ä»¶åˆ é™¤ä¹‹å‰è½¬å‚¨çš„æ¬¡æ•°ï¼Œ0 æŒ‡æ²¡æœ‰å¤‡ä»½ï¼Œ5 æŒ‡ä¿ç•™ 5 ä¸ªå¤‡ä»½</li>
<li>tabooext [+] listï¼šè®© logrotate ä¸è½¬å‚¨æŒ‡å®šæ‰©å±•åçš„æ–‡ä»¶ï¼Œç¼ºçœçš„æ‰©å±•åæ˜¯ï¼š.rpm-orig, .rpmsave, v, å’Œï½</li>
<li>missingokï¼šåœ¨æ—¥å¿—è½®å¾ªæœŸé—´ï¼Œä»»ä½•é”™è¯¯å°†è¢«å¿½ç•¥ï¼Œä¾‹å¦‚ â€œæ–‡ä»¶æ— æ³•æ‰¾åˆ°â€ ä¹‹ç±»çš„é”™è¯¯ã€‚</li>
<li>size sizeï¼šå½“æ—¥å¿—æ–‡ä»¶åˆ°è¾¾æŒ‡å®šçš„å¤§å°æ—¶æ‰è½¬å‚¨ï¼Œbytes (ç¼ºçœ) åŠ KB (sizek) æˆ– MB (sizem)</li>
<li>compressï¼š é€šè¿‡ gzip å‹ç¼©è½¬å‚¨ä»¥åçš„æ—¥å¿—</li>
<li>compresscmdï¼šæŒ‡å®šä½¿ç”¨å“ªä¸ªå‘½ä»¤æ¥å‹ç¼©æ—¥å¿—æ–‡ä»¶</li>
<li>uncompresscmdï¼šæŒ‡å®šä½¿ç”¨å“ªä¸ªå‘½ä»¤æ¥è§£å‹ç¼©æ—¥å¿—æ–‡ä»¶ã€‚é»˜è®¤æ˜¯gunzip</li>
<li>nocompressï¼š æ—§ç‰ˆæœ¬çš„æ—¥å¿—æ–‡ä»¶ä¸ä¼šè¢«å‹ç¼©</li>
<li>copytruncateï¼šç”¨äºè¿˜åœ¨æ‰“å¼€ä¸­çš„æ—¥å¿—æ–‡ä»¶ï¼ŒæŠŠå½“å‰æ—¥å¿—å¤‡ä»½å¹¶æˆªæ–­</li>
<li>nocopytruncateï¼š å¤‡ä»½æ—¥å¿—æ–‡ä»¶ä½†æ˜¯ä¸æˆªæ–­</li>
<li>create mode owner group ï¼š è½¬å‚¨æ–‡ä»¶ï¼Œä½¿ç”¨æŒ‡å®šçš„æ–‡ä»¶æ¨¡å¼åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶</li>
<li>nocreateï¼š ä¸å»ºç«‹æ–°çš„æ—¥å¿—æ–‡ä»¶</li>
<li>delaycompressï¼š å’Œ compress ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œè½¬å‚¨çš„æ—¥å¿—æ–‡ä»¶åˆ°ä¸‹ä¸€æ¬¡è½¬å‚¨æ—¶æ‰å‹ç¼©</li>
<li>nodelaycompressï¼š è¦†ç›– delaycompress é€‰é¡¹ï¼Œè½¬å‚¨åŒæ—¶å‹ç¼©ã€‚</li>
<li>errors address ï¼š ä¸“å‚¨æ—¶çš„é”™è¯¯ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„ Email åœ°å€</li>
<li>ifempty ï¼šå³ä½¿æ˜¯ç©ºæ–‡ä»¶ä¹Ÿè½¬å‚¨ï¼Œè¿™ä¸ªæ˜¯ logrotate çš„ç¼ºçœé€‰é¡¹ã€‚</li>
<li>notifempty ï¼šå¦‚æœæ˜¯ç©ºæ–‡ä»¶çš„è¯ï¼Œä¸è½¬å‚¨</li>
<li>mail address ï¼š æŠŠè½¬å‚¨çš„æ—¥å¿—æ–‡ä»¶å‘é€åˆ°æŒ‡å®šçš„ E-mail åœ°å€</li>
<li>nomail ï¼š è½¬å‚¨æ—¶ä¸å‘é€æ—¥å¿—æ–‡ä»¶</li>
<li>olddir directoryï¼šå‚¨åçš„æ—¥å¿—æ–‡ä»¶æ”¾å…¥æŒ‡å®šçš„ç›®å½•ï¼Œå¿…é¡»å’Œå½“å‰æ—¥å¿—æ–‡ä»¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</li>
<li>noolddirï¼š è½¬å‚¨åçš„æ—¥å¿—æ–‡ä»¶å’Œå½“å‰æ—¥å¿—æ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹</li>
<li>prerotate/endscriptï¼šåœ¨è½¬å‚¨ä»¥å‰éœ€è¦æ‰§è¡Œçš„å‘½ä»¤å¯ä»¥æ”¾å…¥è¿™ä¸ªå¯¹ï¼Œè¿™ä¸¤ä¸ªå…³é”®å­—å¿…é¡»å•ç‹¬æˆè¡Œ</li>
<li>sharedscriptsï¼šå¦‚æœæŒ‡å®šäº†sharedscriptsï¼Œé‚£ä¹ˆæ— è®ºæœ‰å¤šå°‘æ—¥å¿—ä¸é€šé…ç¬¦æ¨¡å¼ç›¸åŒ¹é…ï¼Œè„šæœ¬éƒ½åªè¿è¡Œä¸€æ¬¡ï¼Œæ•´ä¸ªæ¨¡å¼éƒ½ä¼šä¼ é€’ç»™å®ƒä»¬ã€‚ç„¶è€Œï¼Œå¦‚æœæ¨¡å¼ä¸­æ²¡æœ‰ä¸€ä¸ªæ—¥å¿—éœ€è¦è½®æ¢ï¼Œè„šæœ¬å°±æ ¹æœ¬ä¸ä¼šè¢«è¿è¡Œã€‚å¦‚æœè„šæœ¬ä»¥é”™è¯¯æ–¹å¼é€€å‡ºï¼Œå‰©ä¸‹çš„åŠ¨ä½œå°†ä¸ä¼šå¯¹ä»»ä½•æ—¥å¿—æ‰§è¡Œï¼›</li>
<li></li>
</ol>
<h2>è¿è¡Œç¤ºä¾‹</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">/home/torch/koko.log {
        su ceasia ceasia <span class="pl-c"><span class="pl-c">#</span>æƒé™</span>
        daily
        dateext
        rotate 14
        compress
        missingok
        copytruncate
        sharedscripts
        notifempty
}

<span class="pl-c"><span class="pl-c">#</span> debugè¿è¡Œ</span>
ceasia@dev-32:<span class="pl-k">~</span>$ logrotate -df /etc/logrotate.d/koko 
WARNING: logrotate <span class="pl-k">in</span> debug mode does nothing except printing debug messages<span class="pl-k">!</span>  Consider using verbose mode (-v) instead <span class="pl-k">if</span> this is not what you want.

reading config file /etc/logrotate.d/koko
Reading state from file: /var/lib/logrotate/status
Allocating <span class="pl-c1">hash</span> table <span class="pl-k">for</span> state file, size 64 entries

Handling 1 logs

rotating pattern: /home/torch/koko.log  forced from <span class="pl-c1">command</span> line (14 rotations)
empty log files are not rotated, old logs are removed
considering log /home/torch/koko.log
Creating new state
  Now: 2023-01-31 15:27
  Last rotated at 2023-01-31 15:00
  log needs rotating
rotating log /home/torch/koko.log, log-<span class="pl-k">&gt;</span>rotateCount is 14
dateext suffix <span class="pl-s"><span class="pl-pds">'</span>-20230131<span class="pl-pds">'</span></span>
glob pattern <span class="pl-s"><span class="pl-pds">'</span>-[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]<span class="pl-pds">'</span></span>
glob finding old rotated logs failed
copying /home/torch/koko.log to /home/torch/koko.log-20230131
truncating /home/torch/koko.log
compressing log with: /bin/gzip

<span class="pl-c"><span class="pl-c">#</span> å¼ºåˆ¶è¿è¡Œ</span>
ceasia@dev-32:<span class="pl-k">~</span>$ sudo logrotate -fv /etc/logrotate.d/koko 
reading config file /etc/logrotate.d/koko
Reading state from file: /var/lib/logrotate/status
Allocating <span class="pl-c1">hash</span> table <span class="pl-k">for</span> state file, size 64 entries

Handling 1 logs

rotating pattern: /home/torch/koko.log  forced from <span class="pl-c1">command</span> line (14 rotations)
empty log files are not rotated, old logs are removed
switching euid to 1000 and egid to 1000
considering log /home/torch/koko.log
  Now: 2023-01-31 15:31
  Last rotated at 2023-01-31 15:00
  log does not need rotating (log is empty)
switching euid to 0 and egid to 0

<span class="pl-c"><span class="pl-c">#</span> è®¾ç½®crontab</span>
01 0 <span class="pl-k">*</span> <span class="pl-k">*</span> <span class="pl-k">*</span> /usr/sbin/logrotate /etc/logrotate.d/koko --state /opt/jumpserver/koko/data/logs/logrotate-state
</pre></div>
<div class="highlight highlight-source-shell"><pre class="notranslate">/var/log/nginx/<span class="pl-k">*</span>.log {
        daily
        dateext
        missingok
        rotate 31
        compress
        delaycompress
        notifempty
        create 0640 nginx root
        sharedscripts
        postrotate
                /bin/kill -USR1 <span class="pl-s"><span class="pl-pds">`</span>cat /usr/local/nginx/logs/nginx.pid <span class="pl-k">2&gt;</span>/dev/null<span class="pl-pds">`</span></span> <span class="pl-k">2&gt;</span>/dev/null <span class="pl-k">||</span> <span class="pl-c1">true</span>
        endscript
}
</pre></div></div>
<div style="font-size:small;margin-top:8px;float:right;">ğŸºè½¬è½½æ–‡ç« è¯·æ³¨æ˜å‡ºå¤„ï¼Œè°¢è°¢ï¼ğŸº</div>
<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">è¯„è®º</button>
<div class="comments" id="comments"></div>
</div>
    <div id="footer">Copyright Â© <span id="year"></span><a href="https://blog.witter.top"> V's Blog </a>
<p><a href="https://beian.miit.gov.cn/" target="_blank">å†€ICPå¤‡2022019998å·</a>
<span id="runday"></span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a>
</p>

<script>
if("06/20/2024"!=""){
    var now=new Date();
    var startSite=new Date("06/20/2024");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("year").innerHTML=now.getFullYear();
    if("å†€ICPå¤‡2022019998å·"!=""){document.getElementById("runday").innerHTML=" â€¢ "+"ç½‘ç«™è¿è¡Œ"+diffDay+"å¤©"+" â€¢ ";}
    else{document.getElementById("runday").innerHTML="ç½‘ç«™è¿è¡Œ"+diffDay+"å¤©"+" â€¢ ";}
}
</script>
</div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n\n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);

function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","ljwtorch/ljwtorch.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}
</script>
<script defer src="https://cloud.umami.is/script.js" data-website-id="3ba773a6-8f89-4549-a750-a200e9bc10a0"></script>

</html>
